# Duffing Oscillator

## Описание проекта

Этот проект представляет собой численное моделирование осциллятора Дюффинга — нелинейной динамической системы, часто используемой для изучения хаотического поведения. Программа на C++ реализует моделирование движения 1000 частиц с использованием двух методов интегрирования: метода Рунге-Кутты 4-го порядка (RK4) и метода Дорманда-Принса 8(5,3) (DP8). Результаты записываются в файлы, а затем визуализируются с помощью Python-скрипта, который строит фазовые портреты и графики средней локальной ошибки между методами.

Проект состоит из:
1. **C++ кода** (main.cpp): моделирование движения частиц и запись данных в файлы duffing_rk4.dat, duffing_dp.dat и diff.dat.
2. **Python-скрипта**: визуализация результатов с интерактивными графиками (фазовые портреты и ошибки).

Цель проекта — сравнить точность методов RK4 и DP8 при решении уравнения Дюффинга и продемонстрировать различия в их поведении.

## Уравнение осциллятора Дюффинга

Осциллятор Дюффинга описывается следующим дифференциальным уравнением второго порядка:

\[
\frac{d^2x}{dt^2} + \delta \frac{dx}{dt} + \alpha x + \beta x^3 = \gamma \cos(\omega t)
\]

Где:
- \(x\) — смещение (координата),
- \(\frac{dx}{dt}\) — скорость,
- \(\delta\) — коэффициент затухания,
- \(\alpha\) — линейная жёсткость,
- \(\beta\) — нелинейная жёсткость,
- \(\gamma\) — амплитуда внешней периодической силы,
- \(\omega\) — частота внешней силы,
- \(t\) — время.

В проекте уравнение преобразуется в систему двух уравнений первого порядка:
\[
\frac{dx}{dt} = v
\]
\[
\frac{dv}{dt} = -\delta v - \alpha x - \beta x^3 + \gamma \cos(\omega t)
\]

## Используемые параметры

- \(\delta = 0.00001\)
- \(\alpha = 0.5\)
- \(\beta = 0.0625\)
- \(\gamma = 5\)
- \(\omega = 2.0\)
- Шаг времени: \(dt = 0.01\)
- Общее время: \(T = 200.0\)
- Количество частиц: \(N = 1000\)

## Структура файлов

- **main.cpp**: Основной код на C++, реализующий численное интегрирование и запись данных.
- **duffing_rk4.dat**: Результаты метода RK4 (координаты \(x\) и скорости \(v\) для каждой частицы).
- **duffing_dp.dat**: Результаты метода DP8 (координаты \(x\) и скорости \(v\) для каждой частицы).
- **diff.dat**: Средние локальные ошибки между RK4 и DP8 по \(x\) и \(v\) для каждого шага времени.
- **visualization.py** (предполагаемое имя): Python-скрипт для визуализации данных.

## Установка и запуск

1. **Сборка C++ кода**:

```bash
g++ main.cpp -o duffing_sim
```

2. **Запуск симуляции**:

```bash
./duffing_sim
```

Это создаст файлы `duffing_rk4.dat`, `duffing_dp.dat` и `diff.dat`.

3. **Запуск визуализации**:  
   Убедитесь, что у вас установлены Python 3 и библиотеки `numpy`, `matplotlib`. Затем выполните:

```bash
python visualization.py
```

(Замените `visualization.py` на имя вашего Python-скрипта, если оно отличается).

## Результаты

- **Фазовые портреты**: Показывают траектории частиц в пространстве \((x, v)\) для методов RK4 и DP8.
- **Средняя локальная ошибка**: Графики демонстрируют разницу между решениями RK4 и DP8 по координате \(x\) и скорости \(v\), приведённой к соразмерной величине с помощью \(dt\).

## Зависимости

- **C++**: Стандартная библиотека (STL), компилятор (например, g++).
- **Python**: `numpy`, `matplotlib`.

## Примечания

- Начальные условия для частиц генерируются случайным образом в диапазоне \([-10, 10]\) для \(x\) и \(v\).
- DP8 считается более точным методом благодаря более высокому порядку, что может быть видно на графиках ошибок при увеличении шага времени \(dt\).
